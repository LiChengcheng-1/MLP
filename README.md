# Low-bit Integer-only Multilayer Perceptron Architecture for Flow Estimation

## overview

This repository contains code for a Multilayer Perceptron (MLP) model trained to predict the velocity of water flow in rivers based on multiple river flow meters. The model is implemented using Python and PyTorch.

## Dataset

The dataset is stored in the data folder. The features of the dataset are generated from data collected by 16 flow meters installed along the river. The target values are the flow data generated by flow meters at the same time. Additionally, the dataset also includes data such as time, water temperature, and water level.

## Model Architecture

The MLP model consists of four multiple fully connected layers with ReLU activation functions.The model is trained using the stochastic gradient descent (SGD) optimizer with optional momentum and weight decay. The number of hidden layers and neurons in each layer can be customized based on requirements. We use the GridSearchCV method from sklearn.model_selection to perform hyperparameter optimization using grid search. The hyperparameters include: optimizer, learning_rate, hidden_layer_sizes, and batch_size.

In the `main.py` file, it includes model training, model validation, model testing, and visualization of model results.

In the `dataset.py` file, it includes data loading, exploratory data analysis (EDA), data normalization, dataset splitting, and instantiation of dataset objects.

In the `model.py` file, we define the model architecture and use grid search to select hyperparameters.

The `checkpoint.pt` file contains the saved parameters of the best model obtained during the training process.

The `earlystopping.py` file contains the code for early stopping.

## Usage

1. Prepare the dataset: Ensure that the dataset containing measurements from flow meters and corresponding velocity values is available in a suitable format.
2. Preprocess the data: Doing correlation analysis to find the most reletive feature. Normalize the input features and prepare the data loaders for training and evaluation.
3. Define the model: Define the architecture of the MLP model including the number of input features, hidden layers, and output units.
4. Train the model: Clicking on the `main.py` file will initiate the training, validation, and testing of the model.
5. Evaluate the model: Two visualizations will be generated: one for validation loss and training loss, and another for the prediction-label line plot. Additionally, the average loss value generated by the current model during testing will be displayed.

## Dependencies

- Python 3.8
- PyTorch
- NumPy
- Matplotlib
- scikit-learn
- Pandas

For more details, please refer to the `requirements.txt` file.

## References

- PyTorch Documentation: https://pytorch.org/docs/stable/index.html
- NumPy Documentation: https://numpy.org/doc/
- Matplotlib Documentation: https://matplotlib.org/stable/contents.html
- scikit-learn Documentation: https://scikit-learn.org/stable/documentation.html

## License
